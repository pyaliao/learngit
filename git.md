## git笔记

### 创建版本库
* 选择一个合适的地方，创建一个空目录，通过`git init`命令把这个目录变成Git可以管理的仓库。`也不一定必须在空目录下创建Git仓库，选择一个已经有东西的目录也是可以的。`

* 所有的版本控制系统，其实只能跟踪文本文件的改动，比如TXT文件，网页，所有的程序代码等等，Git也不例外。

* 然后在仓库中，进行各种操作，创建文件，修改文件，删除文件等等一系列操作

* 把修改放到Git仓库只需要两步。
第一步，用命令`git add`告诉Git，把文件添加到仓库
第二步，用命令`git commit`告诉Git，把文件提交到仓库

### 版本回退

* `git log --pretty=oneline`查看提交记录

* 在Git中，用HEAD表示当前版本，也就是最新的提交1094adb...（注意我的提交ID和你的肯定不一样），上一个版本就是HEAD^，上上一个版本就是HEAD^^，当然往上100个版本写100个^比较容易数不过来，所以写成HEAD~100。

* `git reset --hard HEAD^` 回退到上一个版本

* Git提供了一个命令`git reflog`用来记录你的每一次命令，根据打印出的结果可以查看到`commit id`，即每行结果行首的几位连续的16进制数字，这样你就可以使用`git reset --hard commitID` 回到未来某个版本

* 现在总结一下：
  1. HEAD指向的版本就是当前版本。Git允许我们在版本的历史之间穿梭，使用命令`git reset --hard commit_id`。

  2. 回退前，用`git log`可以查看提交历史，以便确定要`回退`到哪个版本。

  3. 要重返未来，用`git reflog`查看命令历史，以便确定要回到未来的哪个版本。

### 工作区和暂存区

* 仓库内部就是工作区

* ![stage](stage.png)

* `git status` 查看仓库状态

* `git add`命令实际上就是把要提交的所有修改放到暂存区（Stage），然后，执行`git commit`就可以一次性把暂存区的所有修改提交到分支。


### 管理修改
* Git跟踪并管理的是修改，而非文件。什么是修改？比如你新增了一行，这就是一个修改，删除了一行，也是一个修改，更改了某些字符，也是一个修改，删了一些又加了一些，也是一个修改，甚至创建一个新文件，也算一个修改。

* `git add`将工作区修改添加到暂存区，`git commit`将暂存区修改提交，因此，提交之前一定要add工作区的修改，因为每次修改，如果不用git add到暂存区，那就不会加入到commit中。

* `git add file ---> git commit -m 'details about commit'`

* 用`git diff HEAD -- file`命令可以查看工作区和版本库里面最新版本的区别

### 撤销修改
* 场景1：当你改乱了工作区某个文件的内容但还没有add到暂存区，想直接丢弃工作区的修改时，用命令`git checkout -- file`。

* 场景2：当你不但改乱了工作区某个文件的内容，还添加到了暂存区时，想丢弃修改，分两步，第一步用命令`git reset HEAD <file>`，就回到了场景1，第二步按场景1操作。

* 场景3：已经提交了不合适的修改到版本库时，想要撤销本次提交，参考版本回退一节，不过前提是没有推送到远程库。

### 删除文件

* 可以直接手动从工作区删除文件

* 如果要从版本库删除文件，则用命令`git rm file`删掉，并且`git commit`

* 另一种情况是删错了，因为版本库里还有呢，所以可以很轻松地把误删的文件恢复到最新版本：
  ```
  git checkout -- file
  ```
  `git checkout`其实是用版本库里的版本替换工作区的版本，无论工作区是修改还是删除，都可以“一键还原”。

* 命令`git rm`用于删除一个文件。`如果一个文件已经被提交到版本库，那么你永远不用担心误删，但是要小心，你只能恢复文件到最新版本，你会丢失最近一次提交后你修改的内容。`

* 注意：从来没有被添加到版本库就被删除的文件，是无法恢复的！

### 分支管理

* `git branch branchname` -- 创建分支
* `git checkout branchname` -- 切换分支
* `git checkout -b branchname` -- 创建并切换分支，等价于上面两条命令
* `git branch` -- 查看所有分支，当前工作的分支前面有一个星号

* Git鼓励大量使用分支：
  1. 查看分支：`git branch`
  2. 创建分支：`git branch <name>`
  3. 切换分支：`git checkout <name>`或者`git switch <name>`
  4. 创建+切换分支：`git checkout -b <name>`或者`git switch -c <name>`
  5. 合并某分支到当前分支：`git merge <name>`
  6. 删除分支：`git branch -d <name>`
  我是分支branch1
